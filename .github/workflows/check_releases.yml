name: Check upstream for new release
on:
  schedule:
    # check each night at 1 AM
    - cron: '00 01 * * *'
  workflow_dispatch: {}
  push: {}

jobs:
  check-releases:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        node-version: [16.x] # This should be LTS

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - id: check-version
      name: Check upstream version
      uses: pozetroninc/github-action-get-latest-release@v0.5.0
      with:
        repository: sindresorhus/strip-final-newline
        excludes: prerelease, draft

    - name: Debug
      run: |
        RELEASE=${{ steps.check-version.outputs.release }}
        echo "Latest release is: ${RELEASE}"
        if git rev-parse -q --verify "refs/tags/${RELEASE}"; then
          echo "Tag exists here"
        else
          echo "Tag does not exist here"
        fi
